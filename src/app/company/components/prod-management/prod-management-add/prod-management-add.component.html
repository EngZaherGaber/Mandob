<div *ngIf="showForm" class="conainter-fluid position-relative">
    <div class="row">
        <div class="col-md-6 col-12">
            <p-accordion value="0" (onOpen)="openVariantPanel($event)">
                <p-accordion-panel value="0">
                    <p-accordion-header>المعلومات الاساسية</p-accordion-header>
                    <p-accordion-content>
                        <div class="d-flex flex-column gap-4 pt-5 pb-2 px-2 ">
                            <dynamic-input [object]="objs[0]" [FEcontrol]="getControl('productName')" />
                            <dynamic-input [object]="objs[1]" [FEcontrol]="getControl('productDescription')" />
                        </div>
                    </p-accordion-content>
                </p-accordion-panel>
                <p-accordion-panel value="1" [disabled]="form.invalid">
                    <p-accordion-header>الخيارات</p-accordion-header>
                    <p-accordion-content>
                        <div class="d-flex flex-column gap-4 pt-2 pb-2 px-2 ">
                            <div
                                class="d-flex justify-content-between align-items-center border-bottom border-4 pb-2 pe-2">
                                <div class="d-flex justify-content-start align-items-center gap-2  ">
                                    <p-button [disabled]="!optionName.value" size="small" [text]="true"
                                        (onClick)="addOptionName(optionName)" [rounded]="true"
                                        icon="pi pi-plus"></p-button>
                                    <p-floatlabel variant="over">
                                        <label for="optionNameInpt">اضافة خيار</label>
                                        <input id="optionNameInpt" #optionName type="text" pInputText
                                            [style]="{'width':'100%'}" />
                                    </p-floatlabel>
                                </div>
                            </div>
                            <div *ngFor="let option of options;let optionIndex=index;let last=last"
                                class="d-flex flex-column gap-2">
                                <div class="d-flex justify-content-between align-items-center  pb-2">
                                    <div class="col-6 ">
                                        <div class="d-flex justify-content-start gap-2 align-items-center">
                                            <p-button size="small" [text]="true" (onClick)="removeOption(optionIndex)"
                                                [rounded]="true" icon="pi pi-times" severity="danger"></p-button>
                                            <span class="fw-bold">{{option.optionName}}</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="d-flex justify-content-start align-items-center gap-2 ">
                                            <p-button size="small" [text]="true"
                                                (onClick)="addOptionValue(optionValue,optionIndex)" [rounded]="true"
                                                icon="pi pi-plus" [disabled]="!optionValue.value"></p-button>
                                            <p-floatlabel variant="over">
                                                <label for="optionValueInpt">اضافة قيمة</label>
                                                <input id="optionValueInpt" #optionValue type="text" pInputText
                                                    [style]="{'width':'100%'}" />
                                            </p-floatlabel>
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="option.values.length > 0"
                                    class="d-flex justify-content-between align-items-center pb-2"
                                    [ngClass]="{'border-bottom border-2':!last}">
                                    <div class="col-6"></div>
                                    <div class="col-6">
                                        <div class="d-flex flex-column gap-2">
                                            <div class="d-flex justify-content-start align-items-center pe-2"
                                                *ngFor="let optionValue of option.values;let valueIndex=index">
                                                <p-button size="small" [text]="true"
                                                    (onClick)="removeOptionValue(optionIndex,valueIndex)"
                                                    [rounded]="true" icon="pi pi-times" severity="danger"></p-button>
                                                <span>{{optionValue.valueName}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- <small>القيم</small> -->
                            </div>
                        </div>
                    </p-accordion-content>
                </p-accordion-panel>
                <p-accordion-panel value="2" [disabled]="checkVariantPanel()">
                    <p-accordion-header>التشكيل</p-accordion-header>
                    <p-accordion-content>
                        <div class="d-flex flex-column gap-4 pt-2 pb-2 px-2 ">
                            <div class="d-flex flex-column gap-2 pb-2" [ngClass]="{'border-bottom border-2':!last}"
                                *ngFor="let variant of variants;let last=last">
                                <span class="fw-bold mb-4"><i class="pi pi-circle"></i> {{variant.variantName}}</span>
                                <div class="d-flex justify-content-between gap-2">
                                    <p-floatlabel variant="over">
                                        <label [for]="variant.variantName+'-SKU'">SKU </label>
                                        <input [id]="variant.variantName+'-SKU'" [(ngModel)]="variant.sku" type="text"
                                            pInputText [style]="{'width':'100%'}" />
                                    </p-floatlabel>
                                    <p-floatlabel variant="over">
                                        <label [for]="variant.variantName+'-stockQuantity'">الكمية</label>
                                        <p-inputNumber [id]="variant.variantName+'-stockQuantity'"
                                            [(ngModel)]="variant.stockQuantity" [step]="1" [min]="0"
                                            [showButtons]="true" [style]="{'width':'100%'}"></p-inputNumber>
                                    </p-floatlabel>
                                    <p-floatlabel variant="over">
                                        <label [for]="variant.variantName+'-price'">السعر</label>
                                        <p-inputNumber [id]="variant.variantName+'-price'" [(ngModel)]="variant.price"
                                            [minFractionDigits]="1" [step]="0.1" mode="decimal" [showButtons]="true"
                                            [style]="{'width':'100%'}"></p-inputNumber>
                                    </p-floatlabel>
                                </div>
                            </div>
                            <div class="w-100 d-flex justify-content-start">
                                <p-button label="حفظ المنتج" (onClick)="saveProduct()" icon="pi pi-check"></p-button>
                            </div>
                        </div>
                    </p-accordion-content>
                </p-accordion-panel>
            </p-accordion>
        </div>
        <div class="col-md-6 col-12">
            <p-fileupload #fu accept="image/*" name="myfile[]" [showUploadButton]="false" [showCancelButton]="false"
                [multiple]="true" maxFileSize="1000000" (onSelect)="onSelect($event)" (onRemove)="onRemove($event)"
                class="p-0">
                <ng-template #empty>
                    <div class="d-flex flex-column align-items-center border border-2 rounded-4 p-4">
                        <i class="pi pi-cloud-upload" style="font-size: 50px !important;"></i>
                        <p class="mt-6 mb-0">Drag and drop files to here to upload.</p>
                    </div>
                </ng-template>
            </p-fileupload>
        </div>
    </div>
</div>
<!-- <p-dialog header="تغير كلمة السر" [modal]="true" [(visible)]="resetDialogVisible" [style]="{ width: '25rem' }">
    <div class="d-flex flex-column w-100 gap-4 pt-4">
        <input #optionName type="text" pInputText />
        <div class="d-flex justify-content-end">
            <p-button [disabled]="!optionName.value" label="حفظ" icon="pi pi-angle-check" (onClick)="addOptionName(optionName.value)"/>
        </div>
    </div>

</p-dialog> -->